<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        const socket = io.connect('http://' + document.domain + ':' + location.port);

        socket.on('atualizar_anuncios', () => {
            location.reload();  // Recarrega a página ao receber o evento
        });
    </script>
    <title>Anuncios</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            background: linear-gradient(to bottom,
                    #e50727 -50%,
                    #7e1572 50%,
                    #e50727 150%);
            background-repeat: no-repeat;
            /* Impede repetição */
            background-size: cover;
            /* Faz o gradiente cobrir toda a área */
            display: flex;
            flex-direction: column;
        }

        main {
            flex: 1;
        }

        .moldura {
            height: 100vhs;
        }

        .cabecalho {
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;

        }

        .cabecalho #logo {
            margin-left: 20px;
        }

        .conteudo {
            width: 100vw;
            background-color: white;
            height: 75vh;
            margin-top: -4px;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .conteudo #anuncio {
            width: 70%;
            height: 97%;
            display: flex;
            background-color: black;
            border-radius: 20px;
        }

        .conteudo #mensagem {
            width: 28%;
            height: 97%;
            background-color: blue;
        }

        .rodape {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .rodape .local {
            margin-left: 20px;
        }

        .rodape h1 {
            color: white;
            font-size: 1.5em;
            margin: 0;
        }

        .rodape .grafismo {
            margin-right: 0px;

        }
        .carousel-inner {
            width: 100%;
            height: 100%;
        }
        .carousel-item {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
        }

        .carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
        }
    </style>
</head>

<body>
    <header>
        <div class="cabecalho">
            <div id="logo">
                <img src="../static/img/logo-una.png" width="220px" alt="">
            </div>
            <div id="graf1">
                <img src="../static/img/grafismo1.png" width="550px">
            </div>
        </div>
    </header>
    <main>
        <div class="conteudo">
            <div id="anuncio">
                <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        {% with anuncios = anuncios%}
                        {% if anuncios %}
                        {% for cada in anuncios %}
                        {%if ".mp4" in cada%}
                        <div class="carousel-item {% if loop.first %}active{% endif %}">
                            <video class="d-block .video-slide" muted autoplay controls alt="Second slide">
                                <source src="{{cada}}" type="video/mp4">
                            </video>
                        </div>
                        {%else%}
                        <div class="carousel-item {% if loop.first %}active{% endif %}">
                            <img class="d-block " src="{{cada}}" alt="Second slide">
                        </div>
                        {%endif%}


                        {% endfor %}
                        {% endif %}
                        {%endwith%}

                    </div>
                </div>
            </div>
            <div id="mensagem">

            </div>
        </div>
    </main>
    <footer>
        <div class="rodape">
            <div class="local">
                <h1 id="localAtual">FACULDADE UNA DIVINÓPOLIS</h1>
            </div>
            <div class="hora">
                <h1 id="horaAtual"></h1>
            </div>
            <div class="grafismo">
                <img src="../static/img/grafismo2.png" width="400px" alt="">
            </div>
        </div>
    </footer>

    <script>

        function attRelogio() {
            let agora = new Date();
            let week = new Array(7)
            week[0] = "Domingo";
            week[1] = "Segunda-feira";
            week[2] = "Terça-feira";
            week[3] = "Quarta-feira";
            week[4] = "Quinta-feira";
            week[5] = "Sexta-feira";
            week[6] = "Sábado";
            let weekDay = week[agora.getDay()];
            let hora = agora.getHours().toString().padStart(2, '0');
            let minutos = agora.getMinutes().toString().padStart(2, '0');
            let segundos = agora.getSeconds().toString().padStart(2, '0');
            const horaAtual = `${hora}:${minutos}:${segundos}`;
            console.log(weekDay + '-' + horaAtual);
            document.getElementById('horaAtual').textContent = weekDay + ' - ' + horaAtual;
        }
        attRelogio();
        setInterval(attRelogio, 1000); // Atualiza a cada segundo
        document.addEventListener('DOMContentLoaded', function () {
            const carousel = $('#carouselExampleSlidesOnly');

            function stopAllVideos() {
                const videos = document.querySelectorAll('video');
                videos.forEach(video => {
                    video.pause();
                    video.currentTime = 0;
                });
            }

            function setSlideInterval() {
                const activeSlide = document.querySelector('.carousel-item.active');
                const video = activeSlide.querySelector('video');

                if (video) {
                    carousel.carousel('pause');
                    video.play().catch(err => console.error(err));

                    video.onended = function () {
                        carousel.carousel('next');
                    };
                } else {
                    // Avança após 5 segundos
                    setTimeout(() => {
                        carousel.carousel('next');
                    }, 10000);
                }
            }

            carousel.on('slide.bs.carousel', function () {
                stopAllVideos();
            });

            carousel.on('slid.bs.carousel', function () {
                setSlideInterval();
            });

            // Inicia o carrossel manualmente e executa o controle
            carousel.carousel({ interval: false, pause: true });
            setSlideInterval();
        });
    </script>

</body>

</html>